<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Extensions · AEPsych</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="This page details how to use extensions to dynamically add functionality to AEPsych "/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Extensions · AEPsych"/><meta property="og:type" content="website"/><meta property="og:url" content="https://aepsych.org/"/><meta property="og:description" content="This page details how to use extensions to dynamically add functionality to AEPsych "/><meta property="og:image" content="https://aepsych.org/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://aepsych.org/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="/js/code_block_buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/cookie_consent.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/cookie_consent.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/static-logo.png" alt="AEPsych"/><h2 class="headerTitleWithLogo">AEPsych</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/demos/" target="_self">Demos</a></li><li class="siteNavGroupActive"><a href="/docs/introduction" target="_self">Docs</a></li><li class=""><a href="/tutorials/" target="_self">Tutorials</a></li><li class=""><a href="/api/" target="_self">API Reference</a></li><li class=""><a href="https://github.com/facebookresearch/aepsych" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Advanced topics</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">About</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/papers">Papers related to AEPsych</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">General</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/getting_started">Getting Started with AEPsych</a></li><li class="navListItem"><a class="navItem" href="/docs/configs">Writing Config Files</a></li><li class="navListItem"><a class="navItem" href="/docs/clients">AEPsych clients</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Background materials</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/psychophysics_intro">A brief introduction to Psychophysics</a></li><li class="navListItem"><a class="navItem" href="/docs/gp_intro">A brief introduction to Gaussian Process active learning</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">For developers</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/api_overview">API Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/db_overview">Database Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/server_overview">Server API Overview</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Advanced topics</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/finish_criteria">Advanced Strategy Configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/parameters">Advanced Parameter Configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/speed">Active Learning Speedups</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/extensions">Extensions</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/facebookresearch/aepsych/blob/main/docs/extensions.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Extensions</h1></header><article><div><span><p>This page details how to use extensions to dynamically add functionality to AEPsych
without directly changing the package. This requires writing separate Python scripts
that will be run when a config calls for it in a setup message.</p>
<p><h2>Running Extension Scripts</h2>
In order to run extension scripts, the Config needs to know the path of the extension
script. These can be any Python script. The extensions option is added to the common
block of a config with a list of paths to each extension to be run. The extensions are
run when the server gets the setup message with this config. Each extension script
listed is run in the order that they are defined in common.</p>
<pre><code class="hljs css language-ini"><span class="hljs-section">[common]</span>
<span class="hljs-attr">parnames</span> = [signal1]
<span class="hljs-attr">outcome_types</span> = [binary]
<span class="hljs-attr">stimuli_per_trial</span> = <span class="hljs-number">1</span>
<span class="hljs-attr">strategy_names</span> = [opt_strat]
<span class="hljs-attr">extensions</span> = [./extension_script1.py, ./extension_script2.py] <span class="hljs-comment"># Needs to be path, can be absolute, can be relative to where server is started</span>
</code></pre>
<p>The extensions are simply Python scripts! <strong>Do not include any extensions unless you know exactly what they do!</strong></p>
<p>Below is a common pattern to add or modify AEPsych functionality. As extensions are just
Python scripts, they can do anything a regular Python script can do and it will run on
the server.</p>
<p><h3>Registering New Objects</h3></p>
<p>The cleanest way to add new AEPsych functionality is to register a new object with the <code>Config</code> class.
For example, we could write a script called
<code>new_objects.py</code> containing the following code, which would add a new
VerboseGPClassificationModel model that a config could use. This model subclasses the regular <code>GPClassificationModel</code>, so it behaves identitically except for the <code>fit</code> method, which we have overwritten to print more verbose information.</p>
<pre><code class="hljs css language-python"><span class="hljs-keyword">from</span> aepsych.config <span class="hljs-keyword">import</span> Config
<span class="hljs-keyword">from</span> aepsych <span class="hljs-keyword">import</span> GPClassificationModel

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">VerboseGPClassificationModel</span><span class="hljs-params">(GPClassificationModel)</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">fit</span><span class="hljs-params">(
        self,
        train_x,
        train_y,
        warmstart_hyperparams=False,
        warmstart_induc=False,
        **kwargs,
    )</span>:</span>
        <span class="hljs-string">"""Like the usual GPClassificationModel but more verbose."""</span>

        <span class="hljs-comment"># Print how many points we're fitting on</span>
        print(<span class="hljs-string">f"Fitting model on <span class="hljs-subst">{len(train_y)}</span> data points!"</span>)

        <span class="hljs-keyword">return</span> super().fit(
            train_x, train_y, warmstart_hyperparams, warmstart_induc, **kwargs
        )


<span class="hljs-comment"># You can define whatever objects you want, each of them need to be added to the Config</span>
<span class="hljs-comment"># as below. Once this is done, they can be referred to by name in configs.</span>
Config.register_object(VerboseGPClassificationModel)
</code></pre>
<p>This new model would be used in a config as follows:</p>
<pre><code class="hljs css language-ini"><span class="hljs-section">[common]</span>
<span class="hljs-attr">parnames</span> = [signal1]
<span class="hljs-attr">outcome_types</span> = [binary]
<span class="hljs-attr">stimuli_per_trial</span> = <span class="hljs-number">1</span>
<span class="hljs-attr">strategy_names</span> = [opt_strat]
<span class="hljs-attr">extensions</span> = [./extensions_example/new_objects.py]

<span class="hljs-section">[signal1]</span>
<span class="hljs-attr">par_type</span> = continuous
<span class="hljs-attr">lower_bound</span> = <span class="hljs-number">1</span>
<span class="hljs-attr">upper_bound</span> = <span class="hljs-number">100</span>

<span class="hljs-section">[opt_strat]</span>
<span class="hljs-attr">model</span> = VerboseGPClassificationModel
<span class="hljs-attr">generator</span> = SobolGenerator
</code></pre>
<p>Notice how we can simply refer to the new object by its name
&quot;VerboseGPClassificationModel&quot;, this is available in addition to the original
GPClassificationModel as we did not modify the orignal, just subclassed it.</p>
<p>A complete script for this extenion can be found <a href="https://github.com/facebookresearch/aepsych/blob/main/extensions_example/new_objects.py">here</a>.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/speed"><span class="arrow-prev">← </span><span>Active Learning Speedups</span></a></div></div></div><nav class="onPageNav"></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/favicon.ico" alt="AEPsych" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/introduction">Introduction</a><a href="/docs/getting_started">Getting Started</a><a href="/tutorials/">Tutorials</a><a href="/api/">API Reference</a></div><div><h5>Legal</h5><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noreferrer noopener">Privacy</a><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noreferrer noopener">Terms</a></div><div><div class="footerSection"><h5>Social</h5><div class="social"><a class="github-button" href="https://github.com/facebookresearch/aepsych" data-count-href="https://github.com/facebookresearch/aepsych/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star AEPsych on GitHub">aepsych</a></div></div></div></section><a href="https://opensource.facebook.com/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2025 Meta Platforms, Inc.  Built with Docusaurus.</section><div class="cookie-container"><p>We use cookies to enhance your experience, and to analyse the use of our website. By clicking or navigating, you agree to allow our usage of cookies.</p><button class="cookie-btn">accept</button></div></footer></div></body></html>