<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>AEPsych · Adaptive experimentation for human perception and perceptually-informed outcomes</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="Adaptive experimentation for human perception and perceptually-informed outcomes"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="AEPsych · Adaptive experimentation for human perception and perceptually-informed outcomes"/><meta property="og:type" content="website"/><meta property="og:url" content="https://aepsych.org/"/><meta property="og:description" content="Adaptive experimentation for human perception and perceptually-informed outcomes"/><meta property="og:image" content="https://aepsych.org/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://aepsych.org/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="/js/code_block_buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/cookie_consent.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/cookie_consent.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/static-logo.png" alt="AEPsych"/><h2 class="headerTitleWithLogo">AEPsych</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/demos/" target="_self">Demos</a></li><li class=""><a href="/docs/introduction" target="_self">Docs</a></li><li class=""><a href="/tutorials/" target="_self">Tutorials</a></li><li class=""><a href="/api/" target="_self">API Reference</a></li><li class=""><a href="https://github.com/facebookresearch/aepsych" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div>
<script type="text/javascript" id="documentation_options" data-url_root="./" src="/js/documentation_options.js"></script>
<script type="text/javascript" src="/js/jquery.js"></script>
<script type="text/javascript" src="/js/underscore.js"></script>
<script type="text/javascript" src="/js/doctools.js"></script>
<script type="text/javascript" src="/js/language_data.js"></script>
<script type="text/javascript" src="/js/searchtools.js"></script>
<div class="sphinx"><div class="document">
<div class="documentwrapper">
<div class="bodywrapper">
<div class="body" role="main">
<section id="aepsych-acquisition">
<h1>aepsych.acquisition<a class="headerlink" href="#aepsych-acquisition" title="Permalink to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-aepsych.acquisition.bvn">
<span id="aepsych-acquisition-bvn-module"></span><h2>aepsych.acquisition.bvn module<a class="headerlink" href="#module-aepsych.acquisition.bvn" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="aepsych.acquisition.bvn.bvn_cdf">
<span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.bvn.</span></span><span class="sig-name descname"><span class="pre">bvn_cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/bvn.html#bvn_cdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.bvn.bvn_cdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the bivariate normal CDF.</p>
<p>WARNING: Implements only the routine for moderate levels of correlation. Will be
inaccurate and should not be used for correlations larger than 0.925.</p>
<p>Standard (mean 0, var 1) bivariate normal distribution with correlation r.
Evaluated from -inf to xu, and -inf to yu.</p>
<p>Based on function developed by Alan Genz:
<a class="reference external" href="http://www.math.wsu.edu/faculty/genz/software/matlab/bvn.m">http://www.math.wsu.edu/faculty/genz/software/matlab/bvn.m</a></p>
<p>based in turn on
Drezner, Z and G.O. Wesolowsky, (1989),
On the computation of the bivariate normal inegral,
Journal of Statist. Comput. Simul. 35, pp. 101-107.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xu</strong> (<em>torch.Tensor</em>) – Upper limits for cdf evaluation in x</p></li>
<li><p><strong>yu</strong> (<em>torch.Tensor</em>) – Upper limits for cdf evaluation in y</p></li>
<li><p><strong>r</strong> (<em>torch.Tensor</em>) – BVN correlation</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor of cdf evaluations of same size as xu, yu, and r.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>
</section>
<section id="module-aepsych.acquisition.lookahead">
<span id="aepsych-acquisition-lookahead-module"></span><h2>aepsych.acquisition.lookahead module<a class="headerlink" href="#module-aepsych.acquisition.lookahead" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="aepsych.acquisition.lookahead.Hb">
<span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.lookahead.</span></span><span class="sig-name descname"><span class="pre">Hb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/lookahead.html#Hb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.lookahead.Hb" title="Permalink to this definition">¶</a></dt>
<dd><p>Binary entropy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>p</strong> (<em>torch.Tensor</em>) – torch.Tensor of probabilities.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Tensor</em></p>
</dd>
</dl>
<p>Returns: Binary entropy for each probability.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="aepsych.acquisition.lookahead.MI_fn">
<span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.lookahead.</span></span><span class="sig-name descname"><span class="pre">MI_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Px</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">py1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/lookahead.html#MI_fn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.lookahead.MI_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>Average mutual information.
H(p) - E_y*[H(p | y*)]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Px</strong> (<em>torch.Tensor</em>) – (b x m) Level-set posterior before observation</p></li>
<li><p><strong>P1</strong> (<em>torch.Tensor</em>) – (b x m) Level-set posterior given observation of 1</p></li>
<li><p><strong>P0</strong> (<em>torch.Tensor</em>) – (b x m) Level-set posterior given observation of 0</p></li>
<li><p><strong>py1</strong> (<em>torch.Tensor</em>) – (b x 1) Probability of observing 1</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Tensor</em></p>
</dd>
</dl>
<p>Returns: (b) torch.tensor of mutual information averaged over Xq.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="aepsych.acquisition.lookahead.ClassErr">
<span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.lookahead.</span></span><span class="sig-name descname"><span class="pre">ClassErr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/lookahead.html#ClassErr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.lookahead.ClassErr" title="Permalink to this definition">¶</a></dt>
<dd><p>Expected classification error, min(p, 1-p).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>p</strong> (<em>torch.Tensor</em>) – torch.Tensor of predicted probabilities.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Expected classification error for each probability, computed as min(p, 1 - p).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="aepsych.acquisition.lookahead.SUR_fn">
<span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.lookahead.</span></span><span class="sig-name descname"><span class="pre">SUR_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Px</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">py1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/lookahead.html#SUR_fn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.lookahead.SUR_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>Stepwise uncertainty reduction.</p>
<p>Expected reduction in expected classification error given observation at Xstar,
averaged over Xq.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Px</strong> (<em>torch.Tensor</em>) – (b x m) Level-set posterior before observation</p></li>
<li><p><strong>P1</strong> (<em>torch.Tensor</em>) – (b x m) Level-set posterior given observation of 1</p></li>
<li><p><strong>P0</strong> (<em>torch.Tensor</em>) – (b x m) Level-set posterior given observation of 0</p></li>
<li><p><strong>py1</strong> (<em>torch.Tensor</em>) – (b x 1) Probability of observing 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ol class="loweralpha simple" start="2">
<li><p>torch.Tensor of SUR values.</p></li>
</ol>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="aepsych.acquisition.lookahead.EAVC_fn">
<span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.lookahead.</span></span><span class="sig-name descname"><span class="pre">EAVC_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Px</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">py1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/lookahead.html#EAVC_fn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.lookahead.EAVC_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>Expected absolute value change.</p>
<p>Expected absolute change in expected level-set volume given observation at Xstar.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Px</strong> (<em>torch.Tensor</em>) – (b x m) Level-set posterior before observation</p></li>
<li><p><strong>P1</strong> (<em>torch.Tensor</em>) – (b x m) Level-set posterior given observation of 1</p></li>
<li><p><strong>P0</strong> (<em>torch.Tensor</em>) – (b x m) Level-set posterior given observation of 0</p></li>
<li><p><strong>py1</strong> (<em>torch.Tensor</em>) – (b x 1) Probability of observing 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ol class="loweralpha simple" start="2">
<li><p>torch.Tensor of EAVC values.</p></li>
</ol>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.lookahead.LookaheadAcquisitionFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.lookahead.</span></span><span class="sig-name descname"><span class="pre">LookaheadAcquisitionFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/lookahead.html#LookaheadAcquisitionFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.lookahead.LookaheadAcquisitionFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">AcquisitionFunction</span></code></p>
<p>A localized look-ahead acquisition function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>GPyTorchModel</em>) – The gpytorch model to use.</p></li>
<li><p><strong>target</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold value to target in p-space.</p></li>
<li><p><strong>lookahead_type</strong> (<em>Literal</em><em>[</em><em>"levelset"</em><em>, </em><em>"posterior"</em><em>]</em>) – The type of look-ahead to perform (default is “levelset”).
- If the lookahead_type is “levelset”, the acqf will consider the posterior probability that a point is above or below the target level set.
- If the lookahead_type is “posterior”, the acqf will consider the posterior probability that a point will be detected or not.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.lookahead.LocalLookaheadAcquisitionFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.lookahead.</span></span><span class="sig-name descname"><span class="pre">LocalLookaheadAcquisitionFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/lookahead.html#LocalLookaheadAcquisitionFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.lookahead.LocalLookaheadAcquisitionFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aepsych.acquisition.lookahead.LookaheadAcquisitionFunction" title="aepsych.acquisition.lookahead.LookaheadAcquisitionFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">LookaheadAcquisitionFunction</span></code></a></p>
<p>A localized look-ahead acquisition function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>GPyTorchModel</em>) – The gpytorch model to use.</p></li>
<li><p><strong>lookahead_type</strong> (<em>Literal</em><em>[</em><em>"levelset"</em><em>, </em><em>"posterior"</em><em>]</em>) – The type of look-ahead to perform (default is “levelset”).
- If the lookahead_type is “levelset”, the acqf will consider the posterior probability that a point is above or below the target level set.
- If the lookahead_type is “posterior”, the acqf will consider the posterior probability that a point will be detected or not.</p></li>
<li><p><strong>target</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold value to target in p-space.</p></li>
<li><p><strong>posterior_transform</strong> (<em>PosteriorTransform</em><em>, </em><em>optional</em>) – Optional transformation to apply to the posterior. Default: None.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.lookahead.LocalLookaheadAcquisitionFunction.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aepsych.acquisition.lookahead.LocalLookaheadAcquisitionFunction.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate acquisition function at X.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>torch.Tensor</em>) – (b x 1 x d) point at which to evalaute acquisition function.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ol class="loweralpha simple" start="2">
<li><p>torch.Tensor of acquisition values.</p></li>
</ol>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.lookahead.LocalMI">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.lookahead.</span></span><span class="sig-name descname"><span class="pre">LocalMI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/lookahead.html#LocalMI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.lookahead.LocalMI" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aepsych.acquisition.lookahead.LocalLookaheadAcquisitionFunction" title="aepsych.acquisition.lookahead.LocalLookaheadAcquisitionFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocalLookaheadAcquisitionFunction</span></code></a></p>
<p>A localized look-ahead acquisition function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>GPyTorchModel</em>) – The gpytorch model to use.</p></li>
<li><p><strong>lookahead_type</strong> (<em>Literal</em><em>[</em><em>"levelset"</em><em>, </em><em>"posterior"</em><em>]</em>) – The type of look-ahead to perform (default is “levelset”).
- If the lookahead_type is “levelset”, the acqf will consider the posterior probability that a point is above or below the target level set.
- If the lookahead_type is “posterior”, the acqf will consider the posterior probability that a point will be detected or not.</p></li>
<li><p><strong>target</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold value to target in p-space.</p></li>
<li><p><strong>posterior_transform</strong> (<em>PosteriorTransform</em><em>, </em><em>optional</em>) – Optional transformation to apply to the posterior. Default: None.</p></li>
<li><p><strong>args</strong> (<em>Any</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Any</em></p>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.lookahead.LocalSUR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.lookahead.</span></span><span class="sig-name descname"><span class="pre">LocalSUR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/lookahead.html#LocalSUR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.lookahead.LocalSUR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aepsych.acquisition.lookahead.LocalLookaheadAcquisitionFunction" title="aepsych.acquisition.lookahead.LocalLookaheadAcquisitionFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocalLookaheadAcquisitionFunction</span></code></a></p>
<p>A localized look-ahead acquisition function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>GPyTorchModel</em>) – The gpytorch model to use.</p></li>
<li><p><strong>lookahead_type</strong> (<em>Literal</em><em>[</em><em>"levelset"</em><em>, </em><em>"posterior"</em><em>]</em>) – The type of look-ahead to perform (default is “levelset”).
- If the lookahead_type is “levelset”, the acqf will consider the posterior probability that a point is above or below the target level set.
- If the lookahead_type is “posterior”, the acqf will consider the posterior probability that a point will be detected or not.</p></li>
<li><p><strong>target</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold value to target in p-space.</p></li>
<li><p><strong>posterior_transform</strong> (<em>PosteriorTransform</em><em>, </em><em>optional</em>) – Optional transformation to apply to the posterior. Default: None.</p></li>
<li><p><strong>args</strong> (<em>Any</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Any</em></p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="aepsych.acquisition.lookahead.construct_inputs_local_lookahead">
<span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.lookahead.</span></span><span class="sig-name descname"><span class="pre">construct_inputs_local_lookahead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lookahead_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'levelset'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">posterior_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aepsych.acquisition.lookahead.construct_inputs_local_lookahead" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs the input dictionary for initializing local lookahead acquisition functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>GPyTorchModel</em>) – The gpytorch model to use.</p></li>
<li><p><strong>training_data</strong> (<em>None</em>) – Placeholder for compatibility; not used in this function.</p></li>
<li><p><strong>lookahead_type</strong> (<em>Literal</em><em>[</em><em>"levelset"</em><em>, </em><em>"posterior"</em><em>]</em>) – Type of look-ahead to perform. Default is “levelset”.
- If the lookahead_type is “levelset”, the acqf will consider the posterior probability that a point is above or below the target level set.
- If the lookahead_type is “posterior”, the acqf will consider the posterior probability that a point will be detected or not.</p></li>
<li><p><strong>target</strong> (<em>float</em><em>, </em><em>optional</em>) – Target threshold value in probability space. Default is None.</p></li>
<li><p><strong>posterior_transform</strong> (<em>PosteriorTransform</em><em>, </em><em>optional</em>) – Optional transformation to apply to the posterior. Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of constructed inputs for local lookahead acquisition functions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any]</p>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.lookahead.GlobalLookaheadAcquisitionFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.lookahead.</span></span><span class="sig-name descname"><span class="pre">GlobalLookaheadAcquisitionFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/lookahead.html#GlobalLookaheadAcquisitionFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.lookahead.GlobalLookaheadAcquisitionFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aepsych.acquisition.lookahead.LookaheadAcquisitionFunction" title="aepsych.acquisition.lookahead.LookaheadAcquisitionFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">LookaheadAcquisitionFunction</span></code></a></p>
<p>A global look-ahead acquisition function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>GPyTorchModel</em>) – The gpytorch model to use.</p></li>
<li><p><strong>lookahead_type</strong> (<em>Literal</em><em>[</em><em>"levelset"</em><em>, </em><em>"posterior"</em><em>]</em>) – The type of look-ahead to perform (default is “levelset”).
- If the lookahead_type is “levelset”, the acqf will consider the posterior probability that a point is above or below the target level set.
- If the lookahead_type is “posterior”, the acqf will consider the posterior probability that a point will be detected or not.</p></li>
<li><p><strong>target</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold value to target in p-space.</p></li>
<li><p><strong>posterior_transform</strong> (<em>PosteriorTransform</em><em>, </em><em>optional</em>) – Optional transformation to apply to the posterior.</p></li>
<li><p><strong>query_set_size</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of points in the query set.</p></li>
<li><p><strong>Xq</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – (m x d) global reference set.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.lookahead.GlobalLookaheadAcquisitionFunction.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aepsych.acquisition.lookahead.GlobalLookaheadAcquisitionFunction.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate acquisition function at X.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>torch.Tensor</em>) – (b x 1 x d) point at which to evalaute acquisition function.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ol class="loweralpha simple" start="2">
<li><p>torch.Tensor of acquisition values.</p></li>
</ol>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.lookahead.GlobalMI">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.lookahead.</span></span><span class="sig-name descname"><span class="pre">GlobalMI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/lookahead.html#GlobalMI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.lookahead.GlobalMI" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aepsych.acquisition.lookahead.GlobalLookaheadAcquisitionFunction" title="aepsych.acquisition.lookahead.GlobalLookaheadAcquisitionFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">GlobalLookaheadAcquisitionFunction</span></code></a></p>
<p>A global look-ahead acquisition function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>GPyTorchModel</em>) – The gpytorch model to use.</p></li>
<li><p><strong>lookahead_type</strong> (<em>Literal</em><em>[</em><em>"levelset"</em><em>, </em><em>"posterior"</em><em>]</em>) – The type of look-ahead to perform (default is “levelset”).
- If the lookahead_type is “levelset”, the acqf will consider the posterior probability that a point is above or below the target level set.
- If the lookahead_type is “posterior”, the acqf will consider the posterior probability that a point will be detected or not.</p></li>
<li><p><strong>target</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold value to target in p-space.</p></li>
<li><p><strong>posterior_transform</strong> (<em>PosteriorTransform</em><em>, </em><em>optional</em>) – Optional transformation to apply to the posterior.</p></li>
<li><p><strong>query_set_size</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of points in the query set.</p></li>
<li><p><strong>Xq</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – (m x d) global reference set.</p></li>
<li><p><strong>args</strong> (<em>Any</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Any</em></p>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.lookahead.GlobalSUR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.lookahead.</span></span><span class="sig-name descname"><span class="pre">GlobalSUR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/lookahead.html#GlobalSUR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.lookahead.GlobalSUR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aepsych.acquisition.lookahead.GlobalLookaheadAcquisitionFunction" title="aepsych.acquisition.lookahead.GlobalLookaheadAcquisitionFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">GlobalLookaheadAcquisitionFunction</span></code></a></p>
<p>A global look-ahead acquisition function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>GPyTorchModel</em>) – The gpytorch model to use.</p></li>
<li><p><strong>lookahead_type</strong> (<em>Literal</em><em>[</em><em>"levelset"</em><em>, </em><em>"posterior"</em><em>]</em>) – The type of look-ahead to perform (default is “levelset”).
- If the lookahead_type is “levelset”, the acqf will consider the posterior probability that a point is above or below the target level set.
- If the lookahead_type is “posterior”, the acqf will consider the posterior probability that a point will be detected or not.</p></li>
<li><p><strong>target</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold value to target in p-space.</p></li>
<li><p><strong>posterior_transform</strong> (<em>PosteriorTransform</em><em>, </em><em>optional</em>) – Optional transformation to apply to the posterior.</p></li>
<li><p><strong>query_set_size</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of points in the query set.</p></li>
<li><p><strong>Xq</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – (m x d) global reference set.</p></li>
<li><p><strong>args</strong> (<em>Any</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Any</em></p>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.lookahead.ApproxGlobalSUR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.lookahead.</span></span><span class="sig-name descname"><span class="pre">ApproxGlobalSUR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/lookahead.html#ApproxGlobalSUR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.lookahead.ApproxGlobalSUR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aepsych.acquisition.lookahead.GlobalSUR" title="aepsych.acquisition.lookahead.GlobalSUR"><code class="xref py py-class docutils literal notranslate"><span class="pre">GlobalSUR</span></code></a></p>
<p>An approximate global look-ahead acquisition function.
:param model: The gpytorch model to use.
:type model: GPyTorchModel
:param lookahed_type: The type of look-ahead to perform (default is “levelset”).
:type lookahed_type: str
:param target: Threshold value to target in p-space.
:type target: float, optional
:param query_set_size: Number of points in the query set.
:type query_set_size: int, optional
:param Xq: (m x d) global reference set.
:type Xq: torch.Tensor, optional</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>botorch.models.gpytorch.GPyTorchModel</em>) – </p></li>
<li><p><strong>target</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>query_set_size</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – </p></li>
<li><p><strong>Xq</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.lookahead.EAVC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.lookahead.</span></span><span class="sig-name descname"><span class="pre">EAVC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/lookahead.html#EAVC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.lookahead.EAVC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aepsych.acquisition.lookahead.GlobalLookaheadAcquisitionFunction" title="aepsych.acquisition.lookahead.GlobalLookaheadAcquisitionFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">GlobalLookaheadAcquisitionFunction</span></code></a></p>
<p>A global look-ahead acquisition function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>GPyTorchModel</em>) – The gpytorch model to use.</p></li>
<li><p><strong>lookahead_type</strong> (<em>Literal</em><em>[</em><em>"levelset"</em><em>, </em><em>"posterior"</em><em>]</em>) – The type of look-ahead to perform (default is “levelset”).
- If the lookahead_type is “levelset”, the acqf will consider the posterior probability that a point is above or below the target level set.
- If the lookahead_type is “posterior”, the acqf will consider the posterior probability that a point will be detected or not.</p></li>
<li><p><strong>target</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold value to target in p-space.</p></li>
<li><p><strong>posterior_transform</strong> (<em>PosteriorTransform</em><em>, </em><em>optional</em>) – Optional transformation to apply to the posterior.</p></li>
<li><p><strong>query_set_size</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of points in the query set.</p></li>
<li><p><strong>Xq</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – (m x d) global reference set.</p></li>
<li><p><strong>args</strong> (<em>Any</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Any</em></p>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.lookahead.MOCU">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.lookahead.</span></span><span class="sig-name descname"><span class="pre">MOCU</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/lookahead.html#MOCU"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.lookahead.MOCU" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aepsych.acquisition.lookahead.GlobalLookaheadAcquisitionFunction" title="aepsych.acquisition.lookahead.GlobalLookaheadAcquisitionFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">GlobalLookaheadAcquisitionFunction</span></code></a></p>
<p>MOCU acquisition function given in expr. 4 of:</p>
<blockquote>
<div><p>Zhao, Guang, et al. “Uncertainty-aware active learning for optimal Bayesian classifier.”
International Conference on Learning Representations (ICLR) 2021.</p>
</div></blockquote>
<p>A global look-ahead acquisition function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>GPyTorchModel</em>) – The gpytorch model to use.</p></li>
<li><p><strong>lookahead_type</strong> (<em>Literal</em><em>[</em><em>"levelset"</em><em>, </em><em>"posterior"</em><em>]</em>) – The type of look-ahead to perform (default is “levelset”).
- If the lookahead_type is “levelset”, the acqf will consider the posterior probability that a point is above or below the target level set.
- If the lookahead_type is “posterior”, the acqf will consider the posterior probability that a point will be detected or not.</p></li>
<li><p><strong>target</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold value to target in p-space.</p></li>
<li><p><strong>posterior_transform</strong> (<em>PosteriorTransform</em><em>, </em><em>optional</em>) – Optional transformation to apply to the posterior.</p></li>
<li><p><strong>query_set_size</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of points in the query set.</p></li>
<li><p><strong>Xq</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – (m x d) global reference set.</p></li>
<li><p><strong>args</strong> (<em>Any</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Any</em></p>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.lookahead.SMOCU">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.lookahead.</span></span><span class="sig-name descname"><span class="pre">SMOCU</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/lookahead.html#SMOCU"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.lookahead.SMOCU" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aepsych.acquisition.lookahead.GlobalLookaheadAcquisitionFunction" title="aepsych.acquisition.lookahead.GlobalLookaheadAcquisitionFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">GlobalLookaheadAcquisitionFunction</span></code></a></p>
<p>SMOCU acquisition function given in expr. 11 of:</p>
<blockquote>
<div><p>Zhao, Guang, et al. “Bayesian active learning by soft mean objective cost of uncertainty.”
International Conference on Artificial Intelligence and Statistics (AISTATS) 2021.</p>
</div></blockquote>
<p>model (GPyTorchModel): The gpytorch model to use.
lookahead_type (str): The type of look-ahead to perform (default is “posterior”).
target (float, optional): Threshold value to target in p-space. Default is None.
query_set_size (int, optional): Number of points in the query set. Default is 256.
Xq (torch.Tensor, optional): (m x d) global reference set. Default is None.
k (float, optional): Scaling factor for the softmax approximation, controlling the “softness” of the maximum operation. Default is 20.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>botorch.models.gpytorch.GPyTorchModel</em>) – </p></li>
<li><p><strong>target</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>query_set_size</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – </p></li>
<li><p><strong>Xq</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – </p></li>
<li><p><strong>k</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.lookahead.BEMPS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.lookahead.</span></span><span class="sig-name descname"><span class="pre">BEMPS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/lookahead.html#BEMPS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.lookahead.BEMPS" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aepsych.acquisition.lookahead.GlobalLookaheadAcquisitionFunction" title="aepsych.acquisition.lookahead.GlobalLookaheadAcquisitionFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">GlobalLookaheadAcquisitionFunction</span></code></a></p>
<p>BEMPS acquisition function given in:</p>
<blockquote>
<div><p>Tan, Wei, et al. “Diversity Enhanced Active Learning with Strictly Proper Scoring Rules.”
Advances in Neural Information Processing Systems 34 (2021).</p>
</div></blockquote>
<p>scorefun (Callable): Scoring function to use for the BEMPS acquisition function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scorefun</strong> (<em>Callable</em>) – </p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="aepsych.acquisition.lookahead.construct_inputs_global_lookahead">
<span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.lookahead.</span></span><span class="sig-name descname"><span class="pre">construct_inputs_global_lookahead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lookahead_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'levelset'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">posterior_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_set_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aepsych.acquisition.lookahead.construct_inputs_global_lookahead" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs the input dictionary for initializing global lookahead acquisition functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>GPyTorchModel</em>) – The gpytorch model to use.</p></li>
<li><p><strong>training_data</strong> (<em>None</em>) – Placeholder for compatibility; not used in this function.</p></li>
<li><p><strong>lookahead_type</strong> (<em>str</em>) – Type of look-ahead to perform. Default is “levelset”.</p></li>
<li><p><strong>target</strong> (<em>float</em><em>, </em><em>optional</em>) – Target threshold value in probability space. Default is None.</p></li>
<li><p><strong>posterior_transform</strong> (<em>PosteriorTransform</em><em>, </em><em>optional</em>) – Optional transformation to apply to the posterior. Default is None.</p></li>
<li><p><strong>query_set_size</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of points in the query set. Default is 256.</p></li>
<li><p><strong>Xq</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – (m x d) global reference set. If not provided, a Sobol sequence is generated. Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of constructed inputs for global lookahead acquisition functions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any]</p>
</dd>
</dl>
</dd></dl>
</section>
<section id="module-aepsych.acquisition.lookahead_utils">
<span id="aepsych-acquisition-lookahead-utils-module"></span><h2>aepsych.acquisition.lookahead_utils module<a class="headerlink" href="#module-aepsych.acquisition.lookahead_utils" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="aepsych.acquisition.lookahead_utils.posterior_at_xstar_xq">
<span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.lookahead_utils.</span></span><span class="sig-name descname"><span class="pre">posterior_at_xstar_xq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xstar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">posterior_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/lookahead_utils.html#posterior_at_xstar_xq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.lookahead_utils.posterior_at_xstar_xq" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the posteriors of f at single point Xstar and set of points Xq.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>GP</em>) – The model to evaluate.</p></li>
<li><p><strong>Xstar</strong> (<em>torch.Tensor</em>) – (b x 1 x d) observation point.</p></li>
<li><p><strong>Xq</strong> (<em>torch.Tensor</em>) – (b x m x d) reference points.</p></li>
<li><p><strong>posterior_transform</strong> (<em>PosteriorTransform</em><em>, </em><em>optional</em>) – Optional transformation to apply to the posterior. Default: None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple of the following:</dt><dd><ul class="simple">
<li><p>Mu_s: (b x 1) mean at Xstar.</p></li>
<li><p>Sigma2_s: (b x 1) variance at Xstar.</p></li>
<li><p>Mu_q: (b x m) mean at Xq.</p></li>
<li><p>Sigma2_q: (b x m) variance at Xq.</p></li>
<li><p>Sigma_sq: (b x m) covariance between Xstar and each point in Xq.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[torch.Tensor, torch.Tensor, torch.Tensor, torch.Tensor, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="aepsych.acquisition.lookahead_utils.lookahead_levelset_at_xstar">
<span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.lookahead_utils.</span></span><span class="sig-name descname"><span class="pre">lookahead_levelset_at_xstar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xstar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">posterior_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/lookahead_utils.html#lookahead_levelset_at_xstar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.lookahead_utils.lookahead_levelset_at_xstar" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the look-ahead level-set posterior at Xq given observation at xstar.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>GP</em>) – The model to evaluate.</p></li>
<li><p><strong>Xstar</strong> (<em>torch.Tensor</em>) – (b x 1 x d) observation point.</p></li>
<li><p><strong>Xq</strong> (<em>torch.Tensor</em>) – (b x m x d) reference points.</p></li>
<li><p><strong>posterior_transform</strong> (<em>PosteriorTransform</em><em>, </em><em>optional</em>) – Optional transformation to apply to the posterior. Default: None.</p></li>
<li><p><strong>eps</strong> (<em>float</em>) – Small value to avoid division by zero. Default: 1e-8.</p></li>
<li><p><strong>kwargs</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple of the following:</dt><dd><p>Px: (b x m) Level-set posterior at Xq, before observation at xstar.
P1: (b x m) Level-set posterior at Xq, given observation of 1 at xstar.
P0: (b x m) Level-set posterior at Xq, given observation of 0 at xstar.
py1: (b x 1) Probability of observing 1 at xstar.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[torch.Tensor, torch.Tensor, torch.Tensor, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="aepsych.acquisition.lookahead_utils.lookahead_p_at_xstar">
<span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.lookahead_utils.</span></span><span class="sig-name descname"><span class="pre">lookahead_p_at_xstar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xstar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">posterior_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/lookahead_utils.html#lookahead_p_at_xstar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.lookahead_utils.lookahead_p_at_xstar" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the look-ahead response probability posterior at Xq given observation at xstar.</p>
<p>Uses the approximation given in expr. 9 in:
Zhao, Guang, et al. “Efficient active learning for Gaussian process classification by
error reduction.” Advances in Neural Information Processing Systems 34 (2021): 9734-9746.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>GP</em>) – The model to evaluate.</p></li>
<li><p><strong>Xstar</strong> (<em>torch.Tensor</em>) – (b x 1 x d) observation point.</p></li>
<li><p><strong>Xq</strong> (<em>torch.Tensor</em>) – (b x m x d) reference points.</p></li>
<li><p><strong>posterior_transform</strong> (<em>PosteriorTransform</em><em>, </em><em>optional</em>) – Optional transformation to apply to the posterior. Default: None.</p></li>
<li><p><strong>kwargs</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – ignored (here for compatibility with other kinds of lookahead)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple of the following:</dt><dd><ul class="simple">
<li><p>Px: (b x m) Response posterior at Xq, before observation at xstar.</p></li>
<li><p>P1: (b x m) Response posterior at Xq, given observation of 1 at xstar.</p></li>
<li><p>P0: (b x m) Response posterior at Xq, given observation of 0 at xstar.</p></li>
<li><p>py1: (b x 1) Probability of observing 1 at xstar.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[torch.Tensor, torch.Tensor, torch.Tensor, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="aepsych.acquisition.lookahead_utils.approximate_lookahead_levelset_at_xstar">
<span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.lookahead_utils.</span></span><span class="sig-name descname"><span class="pre">approximate_lookahead_levelset_at_xstar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xstar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">posterior_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/lookahead_utils.html#approximate_lookahead_levelset_at_xstar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.lookahead_utils.approximate_lookahead_levelset_at_xstar" title="Permalink to this definition">¶</a></dt>
<dd><p>The look-ahead posterior approximation of Lyu et al.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>GP</em>) – The model to evaluate.</p></li>
<li><p><strong>Xstar</strong> (<em>torch.Tensor</em>) – (b x 1 x d) observation point.</p></li>
<li><p><strong>Xq</strong> (<em>torch.Tensor</em>) – (b x m x d) reference points.</p></li>
<li><p><strong>gamma</strong> (<em>float</em>) – The threshold value.</p></li>
<li><p><strong>posterior_transform</strong> (<em>PosteriorTransform</em><em>, </em><em>optional</em>) – Optional transformation to apply to the posterior. Default: None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple of the following:</dt><dd><ul class="simple">
<li><p>Px: (b x m) Level-set posterior at Xq, before observation at xstar.</p></li>
<li><p>P1: (b x m) Level-set posterior at Xq, given observation of 1 at xstar.</p></li>
<li><p>P0: (b x m) Level-set posterior at Xq, given observation of 0 at xstar.</p></li>
<li><p>py1: (b x 1) Probability of observing 1 at xstar.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[torch.Tensor, torch.Tensor, torch.Tensor, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>
</section>
<section id="module-aepsych.acquisition.lse">
<span id="aepsych-acquisition-lse-module"></span><h2>aepsych.acquisition.lse module<a class="headerlink" href="#module-aepsych.acquisition.lse" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.lse.MCLevelSetEstimation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.lse.</span></span><span class="sig-name descname"><span class="pre">MCLevelSetEstimation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/lse.html#MCLevelSetEstimation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.lse.MCLevelSetEstimation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MCAcquisitionFunction</span></code></p>
<p>Monte-carlo level set estimation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>botorch.models.model.Model</em>) – A fitted model.</p></li>
<li><p><strong>target</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>Tensor</em><em>]</em>) – the level set (after objective transform) to be estimated. Defult to 0.75.</p></li>
<li><p><strong>beta</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>Tensor</em><em>]</em>) – a parameter that governs explore-exploit tradeoff. Defult to 3.84.</p></li>
<li><p><strong>objective</strong> (<em>MCAcquisitionObjective</em><em>, </em><em>optional</em>) – An MCAcquisitionObjective representing the link function
(e.g., logistic or probit.) applied on the samples.
Can be implemented via GenericMCObjective.</p></li>
<li><p><strong>sampler</strong> (<em>MCSampler</em><em>, </em><em>optional</em>) – The sampler used for drawing MC samples.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.lse.MCLevelSetEstimation.acquisition">
<span class="sig-name descname"><span class="pre">acquisition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj_samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/lse.html#MCLevelSetEstimation.acquisition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.lse.MCLevelSetEstimation.acquisition" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the acquisition based on objective samples.</p>
<p>Usually you should not call this directly unless you are
subclassing this class and modifying how objective samples
are generated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj_samples</strong> (<em>torch.Tensor</em>) – Samples from the model, transformed
by the objective. Should be samples x batch_shape.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Acquisition function at the sampled values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.lse.MCLevelSetEstimation.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aepsych.acquisition.lse.MCLevelSetEstimation.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the acquisition function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>torch.Tensor</em>) – Points at which to evaluate.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the acquisition functiona at these points.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="aepsych.acquisition.lse.construct_inputs_lse">
<span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.lse.</span></span><span class="sig-name descname"><span class="pre">construct_inputs_lse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">objective</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.84</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aepsych.acquisition.lse.construct_inputs_lse" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs the input dictionary for initializing the MCLevelSetEstimation acquisition function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>Model</em>) – The fitted model to be used.</p></li>
<li><p><strong>training_data</strong> (<em>None</em>) – Placeholder for compatibility; not used in this function.</p></li>
<li><p><strong>objective</strong> (<em>MCAcquisitionObjective</em><em>, </em><em>optional</em>) – Objective function for transforming samples (e.g., logistic or probit).</p></li>
<li><p><strong>target</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>Tensor</em><em>]</em>) – Level set to be estimated, defaulting to 0.75.</p></li>
<li><p><strong>beta</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>Tensor</em><em>]</em>) – Parameter controlling explore-exploit tradeoff, default is 3.84.</p></li>
<li><p><strong>sampler</strong> (<em>MCSampler</em><em>, </em><em>optional</em>) – Sampler for Monte Carlo sampling; defaults to SobolQMCNormalSampler if not provided.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of constructed inputs for the MCLevelSetEstimation acquisition function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any]</p>
</dd>
</dl>
</dd></dl>
</section>
<section id="module-aepsych.acquisition.mc_posterior_variance">
<span id="aepsych-acquisition-mc-posterior-variance-module"></span><h2>aepsych.acquisition.mc_posterior_variance module<a class="headerlink" href="#module-aepsych.acquisition.mc_posterior_variance" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="aepsych.acquisition.mc_posterior_variance.balv_acq">
<span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.mc_posterior_variance.</span></span><span class="sig-name descname"><span class="pre">balv_acq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj_samps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/mc_posterior_variance.html#balv_acq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.mc_posterior_variance.balv_acq" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate BALV (posterior variance) on a set of objective samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj_samps</strong> (<em>torch.Tensor</em>) – Samples from the GP, transformed by the objective.
Should be samples x batch_shape.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Acquisition function value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.mc_posterior_variance.MCPosteriorVariance">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.mc_posterior_variance.</span></span><span class="sig-name descname"><span class="pre">MCPosteriorVariance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/mc_posterior_variance.html#MCPosteriorVariance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.mc_posterior_variance.MCPosteriorVariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MCAcquisitionFunction</span></code></p>
<p>Posterior variance, computed using samples so we can use objective/transform</p>
<p>Posterior Variance of Link Function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>Model</em>) – A fitted model.</p></li>
<li><p><strong>objective</strong> (<em>MCAcquisitionObjective optional</em>) – An MCAcquisitionObjective representing the link function
(e.g., logistic or probit.) applied on the difference of (usually 1-d)
two samples. Can be implemented via GenericMCObjective. Defaults tp ProbitObjective.</p></li>
<li><p><strong>sampler</strong> (<em>MCSampler</em><em>, </em><em>optional</em>) – The sampler used for drawing MC samples. Defaults to SobolQMCNormalSampler.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.mc_posterior_variance.MCPosteriorVariance.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aepsych.acquisition.mc_posterior_variance.MCPosteriorVariance.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate MCPosteriorVariance on the candidate set <cite>X</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>torch.Tensor</em>) – A <cite>batch_size x q x d</cite>-dim Tensor</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Posterior variance of link function at X that active learning
hopes to maximize</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.mc_posterior_variance.MCPosteriorVariance.acquisition">
<span class="sig-name descname"><span class="pre">acquisition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj_samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/mc_posterior_variance.html#MCPosteriorVariance.acquisition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.mc_posterior_variance.MCPosteriorVariance.acquisition" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the acquisition based on objective samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj_samples</strong> (<em>torch.Tensor</em>) – Samples from the GP, transformed by the objective.
Should be samples x batch_shape.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Acquisition function at the sampled values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="aepsych.acquisition.mc_posterior_variance.construct_inputs">
<span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.mc_posterior_variance.</span></span><span class="sig-name descname"><span class="pre">construct_inputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">objective</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aepsych.acquisition.mc_posterior_variance.construct_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs the input dictionary for initializing the MCPosteriorVariance acquisition function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>Model</em>) – The fitted model to be used.</p></li>
<li><p><strong>training_data</strong> (<em>None</em>) – Placeholder for compatibility; not used in this function.</p></li>
<li><p><strong>objective</strong> (<em>MCAcquisitionObjective</em><em>, </em><em>optional</em>) – Objective function for transforming samples (e.g., logistic or probit).</p></li>
<li><p><strong>sampler</strong> (<em>MCSampler</em><em>, </em><em>optional</em>) – Sampler for Monte Carlo sampling; defaults to SobolQMCNormalSampler if not provided.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of constructed inputs for the MCPosteriorVariance acquisition function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any]</p>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.mc_posterior_variance.MonotonicMCPosteriorVariance">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.mc_posterior_variance.</span></span><span class="sig-name descname"><span class="pre">MonotonicMCPosteriorVariance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/mc_posterior_variance.html#MonotonicMCPosteriorVariance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.mc_posterior_variance.MonotonicMCPosteriorVariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aepsych.acquisition.monotonic_rejection.MonotonicMCAcquisition" title="aepsych.acquisition.monotonic_rejection.MonotonicMCAcquisition"><code class="xref py py-class docutils literal notranslate"><span class="pre">MonotonicMCAcquisition</span></code></a></p>
<p>Initialize MonotonicMCAcquisition</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>Model</em>) – Model to use, usually a MonotonicRejectionGP.</p></li>
<li><p><strong>num_samples</strong> (<em>int</em>) – Number of samples to keep from the rejection sampler. Defaults to 32.</p></li>
<li><p><strong>num_rejection_samples</strong> (<em>int</em>) – Number of rejection samples to draw. Defaults to 1024.</p></li>
<li><p><strong>objective</strong> (<em>MCAcquisitionObjective</em><em>, </em><em>optional</em>) – Objective transform of the GP output
before evaluating the acquisition. Defaults to identity transform.</p></li>
<li><p><strong>args</strong> (<em>Any</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Any</em></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.mc_posterior_variance.MonotonicMCPosteriorVariance.acquisition">
<span class="sig-name descname"><span class="pre">acquisition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj_samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/mc_posterior_variance.html#MonotonicMCPosteriorVariance.acquisition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.mc_posterior_variance.MonotonicMCPosteriorVariance.acquisition" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the acquisition function value for monotonic posterior variance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj_samples</strong> (<em>torch.Tensor</em>) – Samples from the GP, transformed by the objective.
Should have shape samples x batch_shape.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The BALV acquisition function value, representing the posterior variance
calculated over the sample dimension.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
</section>
<section id="module-aepsych.acquisition.monotonic_rejection">
<span id="aepsych-acquisition-monotonic-rejection-module"></span><h2>aepsych.acquisition.monotonic_rejection module<a class="headerlink" href="#module-aepsych.acquisition.monotonic_rejection" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.monotonic_rejection.MonotonicMCAcquisition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.monotonic_rejection.</span></span><span class="sig-name descname"><span class="pre">MonotonicMCAcquisition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/monotonic_rejection.html#MonotonicMCAcquisition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.monotonic_rejection.MonotonicMCAcquisition" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">AcquisitionFunction</span></code></p>
<dl class="simple">
<dt>Acquisition function base class for use with the rejection sampling</dt><dd><p>monotonic GP. This handles the bookkeeping of the derivative
constraint points – implement specific monotonic MC acquisition
in subclasses.</p>
</dd>
</dl>
<p>Initialize MonotonicMCAcquisition</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>Model</em>) – Model to use, usually a MonotonicRejectionGP.</p></li>
<li><p><strong>num_samples</strong> (<em>int</em>) – Number of samples to keep from the rejection sampler. Defaults to 32.</p></li>
<li><p><strong>num_rejection_samples</strong> (<em>int</em>) – Number of rejection samples to draw. Defaults to 1024.</p></li>
<li><p><strong>objective</strong> (<em>MCAcquisitionObjective</em><em>, </em><em>optional</em>) – Objective transform of the GP output
before evaluating the acquisition. Defaults to identity transform.</p></li>
<li><p><strong>deriv_constraint_points</strong> (<em>torch.Tensor</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.monotonic_rejection.MonotonicMCAcquisition.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/monotonic_rejection.html#MonotonicMCAcquisition.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.monotonic_rejection.MonotonicMCAcquisition.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the acquisition function at a set of points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>torch.Tensor</em>) – Points at which to evaluate the acquisition function.
Should be (b) x q x d, and q should be 1.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Acquisition function value at these points.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.monotonic_rejection.MonotonicMCAcquisition.acquisition">
<span class="sig-name descname"><span class="pre">acquisition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj_samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/monotonic_rejection.html#MonotonicMCAcquisition.acquisition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.monotonic_rejection.MonotonicMCAcquisition.acquisition" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj_samples</strong> (<em>Tensor</em>) – </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.monotonic_rejection.MonotonicMCLSE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.monotonic_rejection.</span></span><span class="sig-name descname"><span class="pre">MonotonicMCLSE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/monotonic_rejection.html#MonotonicMCLSE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.monotonic_rejection.MonotonicMCLSE" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aepsych.acquisition.monotonic_rejection.MonotonicMCAcquisition" title="aepsych.acquisition.monotonic_rejection.MonotonicMCAcquisition"><code class="xref py py-class docutils literal notranslate"><span class="pre">MonotonicMCAcquisition</span></code></a></p>
<p>Level set estimation acquisition function for use with monotonic models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>Model</em>) – Underlying model object, usually should be MonotonicRejectionGP.</p></li>
<li><p><strong>deriv_constraint_points</strong> (<em>torch.Tensor</em>) – Points at which the derivative should be constrained.</p></li>
<li><p><strong>target</strong> (<em>float</em>) – Level set value to target (after the objective).</p></li>
<li><p><strong>num_samples</strong> (<em>int</em>) – Number of MC samples to draw in MC acquisition. Defaults to 32.</p></li>
<li><p><strong>num_rejection_samples</strong> (<em>int</em>) – Number of rejection samples from which to subsample monotonic ones. Defaults to 1024.</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – Parameter of the LSE acquisition function that governs exploration vs
exploitation (similarly to the same parameter in UCB). Defaults to 3.84 (1.96 ** 2), which maps to the straddle
heuristic of Bryan et al. 2005.</p></li>
<li><p><strong>objective</strong> (<em>MCAcquisitionObjective</em><em>, </em><em>optional</em>) – Objective transform. Defaults to identity transform.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.monotonic_rejection.MonotonicMCLSE.acquisition">
<span class="sig-name descname"><span class="pre">acquisition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj_samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/monotonic_rejection.html#MonotonicMCLSE.acquisition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.monotonic_rejection.MonotonicMCLSE.acquisition" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the acquisition function value for level set estimation in monotonic models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj_samples</strong> (<em>torch.Tensor</em>) – Tensor of samples from the model, transformed by the objective.
Expected shape is samples x batch_shape.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The acquisition function value, calculated as the difference between an exploration-exploitation term
(based on the variance and <cite>beta</cite> parameter) and the absolute difference between the mean and the target level set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
</section>
<section id="module-aepsych.acquisition.mutual_information">
<span id="aepsych-acquisition-mutual-information-module"></span><h2>aepsych.acquisition.mutual_information module<a class="headerlink" href="#module-aepsych.acquisition.mutual_information" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="aepsych.acquisition.mutual_information.bald_acq">
<span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.mutual_information.</span></span><span class="sig-name descname"><span class="pre">bald_acq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj_samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/mutual_information.html#bald_acq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.mutual_information.bald_acq" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate Mutual Information acquisition function.</p>
<p>With latent function F and X a hypothetical observation at a new point,
I(F; X) = I(X; F) = H(X) - H(X <a href="#id1"><span class="problematic" id="id2">|</span></a>F),
H(X <a href="#id3"><span class="problematic" id="id4">|</span></a>F ) = E_{f} (H(X <a href="#id5"><span class="problematic" id="id6">|</span></a>F =f )
i.e., we take the posterior entropy of the (Bernoulli) observation X given the
current model posterior and subtract the conditional entropy on F, that being
the mean entropy over the posterior for F. This is equivalent to the BALD
acquisition function in Houlsby et al. NeurIPS 2012.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj_samples</strong> (<em>torch.Tensor</em>) – Objective samples from the GP, of
shape num_samples x batch_shape x d_out</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of acquisition at samples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.mutual_information.BernoulliMCMutualInformation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.mutual_information.</span></span><span class="sig-name descname"><span class="pre">BernoulliMCMutualInformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/mutual_information.html#BernoulliMCMutualInformation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.mutual_information.BernoulliMCMutualInformation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MCAcquisitionFunction</span></code></p>
<p>Mutual Information acquisition function for a bernoulli outcome.</p>
<p>Given a model and an objective link function, calculate the mutual
information of a trial at a new point and the distribution on the
latent function.</p>
<p>Objective here should give values in (0, 1) (e.g. logit or probit).</p>
<p>Single Bernoulli mutual information for active learning</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>Model</em>) – A fitted model.</p></li>
<li><p><strong>objective</strong> (<em>MCAcquisitionObjective</em>) – An MCAcquisitionObjective representing the link function
(e.g., logistic or probit)</p></li>
<li><p><strong>sampler</strong> (<em>MCSampler</em><em>, </em><em>optional</em>) – The sampler used for drawing MC samples.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.mutual_information.BernoulliMCMutualInformation.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aepsych.acquisition.mutual_information.BernoulliMCMutualInformation.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate mutual information on the candidate set <cite>X</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>Tensor</em>) – A <cite>batch_size x q x d</cite>-dim Tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor of shape <cite>batch_size x q</cite> representing the mutual
information of a hypothetical trial at X that active
learning hopes to maximize.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.mutual_information.BernoulliMCMutualInformation.acquisition">
<span class="sig-name descname"><span class="pre">acquisition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj_samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/mutual_information.html#BernoulliMCMutualInformation.acquisition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.mutual_information.BernoulliMCMutualInformation.acquisition" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the acquisition function value based on samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj_samples</strong> (<em>torch.Tensor</em>) – Samples from the model, transformed through the objective.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>value of the acquisition function (BALD) at the input samples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="aepsych.acquisition.mutual_information.construct_inputs_mi">
<span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.mutual_information.</span></span><span class="sig-name descname"><span class="pre">construct_inputs_mi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">objective</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aepsych.acquisition.mutual_information.construct_inputs_mi" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs the input dictionary for initializing the BernoulliMCMutualInformation acquisition function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>Model</em>) – The fitted model to use.</p></li>
<li><p><strong>training_data</strong> (<em>None</em>) – Placeholder for compatibility; not used in this function.</p></li>
<li><p><strong>objective</strong> (<em>MCAcquisitionObjective</em><em>, </em><em>optional</em>) – Objective function for transforming samples (e.g., logit or probit).</p></li>
<li><p><strong>sampler</strong> (<em>MCSampler</em><em>, </em><em>optional</em>) – Sampler for Monte Carlo sampling; defaults to SobolQMCNormalSampler if not provided.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of constructed inputs for the BernoulliMCMutualInformation acquisition function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any]</p>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.mutual_information.MonotonicBernoulliMCMutualInformation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.mutual_information.</span></span><span class="sig-name descname"><span class="pre">MonotonicBernoulliMCMutualInformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/mutual_information.html#MonotonicBernoulliMCMutualInformation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.mutual_information.MonotonicBernoulliMCMutualInformation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aepsych.acquisition.monotonic_rejection.MonotonicMCAcquisition" title="aepsych.acquisition.monotonic_rejection.MonotonicMCAcquisition"><code class="xref py py-class docutils literal notranslate"><span class="pre">MonotonicMCAcquisition</span></code></a></p>
<p>Initialize MonotonicMCAcquisition</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>Model</em>) – Model to use, usually a MonotonicRejectionGP.</p></li>
<li><p><strong>num_samples</strong> (<em>int</em>) – Number of samples to keep from the rejection sampler. Defaults to 32.</p></li>
<li><p><strong>num_rejection_samples</strong> (<em>int</em>) – Number of rejection samples to draw. Defaults to 1024.</p></li>
<li><p><strong>objective</strong> (<em>MCAcquisitionObjective</em><em>, </em><em>optional</em>) – Objective transform of the GP output
before evaluating the acquisition. Defaults to identity transform.</p></li>
<li><p><strong>args</strong> (<em>Any</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Any</em></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.mutual_information.MonotonicBernoulliMCMutualInformation.acquisition">
<span class="sig-name descname"><span class="pre">acquisition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj_samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/mutual_information.html#MonotonicBernoulliMCMutualInformation.acquisition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.mutual_information.MonotonicBernoulliMCMutualInformation.acquisition" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the acquisition function value based on samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj_samples</strong> (<em>torch.Tensor</em>) – Samples from the model, transformed through the objective.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>value of the acquisition function (BALD) at the input samples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
</section>
<section id="module-aepsych.acquisition.objective">
<span id="aepsych-acquisition-objective-module"></span><h2>aepsych.acquisition.objective module<a class="headerlink" href="#module-aepsych.acquisition.objective" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.objective.AEPsychObjective">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.objective.</span></span><span class="sig-name descname"><span class="pre">AEPsychObjective</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/objective.html#AEPsychObjective"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.objective.AEPsychObjective" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MCAcquisitionObjective</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> (<em>Any</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Any</em></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.objective.AEPsychObjective.inverse">
<span class="sig-name descname"><span class="pre">inverse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/objective.html#AEPsychObjective.inverse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.objective.AEPsychObjective.inverse" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>Tensor</em>) – </p></li>
<li><p><strong>X</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.objective.FloorGumbelObjective">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.objective.</span></span><span class="sig-name descname"><span class="pre">FloorGumbelObjective</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/objective.html#FloorGumbelObjective"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.objective.FloorGumbelObjective" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">FloorLinkObjective</span></code></p>
<p>Gumbel CDF but with a floor so that its output
is between floor and 1.0. Note that this is not
the standard Gumbel distribution, but rather the
left-skewed Gumbel that arises as the log of the Weibull
distribution, e.g. Treutwein 1995, doi:10.1016/0042-6989(95)00016-X.</p>
<p>Initialize the objective with a floor value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>floor</strong> (<em>float</em>) – The floor value. Defaults to 0.5.</p></li>
<li><p><strong>args</strong> (<em>Any</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Any</em></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.objective.FloorGumbelObjective.link">
<span class="sig-name descname"><span class="pre">link</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/objective.html#FloorGumbelObjective.link"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.objective.FloorGumbelObjective.link" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the link function for input x and floor f</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>samples</strong> (<em>Tensor</em>) – GP samples.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Transformed tensor with the link function applied, where positive infinity values are replaced with 1.0 and negative infinity values are replaced with 0.0.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.objective.FloorGumbelObjective.inverse_link">
<span class="sig-name descname"><span class="pre">inverse_link</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/objective.html#FloorGumbelObjective.inverse_link"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.objective.FloorGumbelObjective.inverse_link" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the inverse link function for input x and floor f</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>samples</strong> (<em>Tensor</em>) – GP samples.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The logarithm of the inverse link function applied to the input samples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.objective.FloorLogitObjective">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.objective.</span></span><span class="sig-name descname"><span class="pre">FloorLogitObjective</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/objective.html#FloorLogitObjective"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.objective.FloorLogitObjective" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">FloorLinkObjective</span></code></p>
<p>Logistic sigmoid (aka expit, aka logistic CDF),
but with a floor so that its output is
between floor and 1.0.</p>
<p>Initialize the objective with a floor value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>floor</strong> (<em>float</em>) – The floor value. Defaults to 0.5.</p></li>
<li><p><strong>args</strong> (<em>Any</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Any</em></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.objective.FloorLogitObjective.link">
<span class="sig-name descname"><span class="pre">link</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/objective.html#FloorLogitObjective.link"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.objective.FloorLogitObjective.link" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the link function for input x and floor f</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>samples</strong> (<em>Tensor</em>) – GP samples.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The Expit function applied to the input samples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.objective.FloorLogitObjective.inverse_link">
<span class="sig-name descname"><span class="pre">inverse_link</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/objective.html#FloorLogitObjective.inverse_link"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.objective.FloorLogitObjective.inverse_link" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the inverse link function for input x and floor f</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>samples</strong> (<em>Tensor</em>) – GP samples.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The logarithm of the inverse link function applied to the input samples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.objective.FloorProbitObjective">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.objective.</span></span><span class="sig-name descname"><span class="pre">FloorProbitObjective</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/objective.html#FloorProbitObjective"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.objective.FloorProbitObjective" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">FloorLinkObjective</span></code></p>
<p>Probit (aka Gaussian CDF), but with a floor
so that its output is between floor and 1.0.</p>
<p>Initialize the objective with a floor value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>floor</strong> (<em>float</em>) – The floor value. Defaults to 0.5.</p></li>
<li><p><strong>args</strong> (<em>Any</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Any</em></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.objective.FloorProbitObjective.link">
<span class="sig-name descname"><span class="pre">link</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/objective.html#FloorProbitObjective.link"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.objective.FloorProbitObjective.link" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the link function for input x and floor f</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>samples</strong> (<em>Tensor</em>) – GP samples.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the cumulative distribution function of the standard normal distribution of the input samples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.objective.FloorProbitObjective.inverse_link">
<span class="sig-name descname"><span class="pre">inverse_link</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/objective.html#FloorProbitObjective.inverse_link"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.objective.FloorProbitObjective.inverse_link" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the inverse link function for input x and floor f</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>samples</strong> (<em>Tensor</em>) – GP samples.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the inverse cumulative distribution function of the standard normal distribution of the input samples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.objective.ProbitObjective">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.objective.</span></span><span class="sig-name descname"><span class="pre">ProbitObjective</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/objective.html#ProbitObjective"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.objective.ProbitObjective" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aepsych.acquisition.objective.AEPsychObjective" title="aepsych.acquisition.objective.objective.AEPsychObjective"><code class="xref py py-class docutils literal notranslate"><span class="pre">AEPsychObjective</span></code></a></p>
<p>Probit objective</p>
<p>Transforms the input through the normal CDF (probit).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> (<em>Any</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Any</em></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.objective.ProbitObjective.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/objective.html#ProbitObjective.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.objective.ProbitObjective.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the objective (normal CDF).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>Tensor</em>) – GP samples.</p></li>
<li><p><strong>X</strong> (<em>Tensor</em><em>, </em><em>optional</em>) – ignored, here for compatibility
with MCAcquisitionObjective.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.objective.ProbitObjective.inverse">
<span class="sig-name descname"><span class="pre">inverse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/objective.html#ProbitObjective.inverse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.objective.ProbitObjective.inverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the inverse of the objective (normal PPF).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>Tensor</em>) – GP samples.</p></li>
<li><p><strong>X</strong> (<em>Tensor</em><em>, </em><em>optional</em>) – ignored, here for compatibility
with MCAcquisitionObjective.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.objective.SemiPProbabilityObjective">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.objective.</span></span><span class="sig-name descname"><span class="pre">SemiPProbabilityObjective</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/semi_p.html#SemiPProbabilityObjective"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.objective.SemiPProbabilityObjective" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">SemiPObjectiveBase</span></code></p>
<p>Wraps the semi-parametric transform into an objective
that gives outcome probabilities</p>
<p>Evaluates the probability objective.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>likelihood</strong> (<em>Likelihood</em><em>)</em><em>. Underlying SemiP likelihood</em><em> (</em><em>which we use for its objective/link</em>) – </p></li>
<li><p><strong>class</strong> (<em>other arguments are passed to the base</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.objective.SemiPProbabilityObjective.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/semi_p.html#SemiPProbabilityObjective.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.objective.SemiPProbabilityObjective.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the probability objective.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>Tensor</em>) – GP samples.</p></li>
<li><p><strong>X</strong> (<em>Tensor</em>) – Inputs at which to evaluate objective. Unlike most AEPsych objectives,
we need X here to split out the intensity dimension.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Response probabilities at the specific X values and function samples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.objective.SemiPProbabilityObjective.from_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/semi_p.html#SemiPProbabilityObjective.from_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.objective.SemiPProbabilityObjective.from_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a SemiPProbabilityObjective from a config object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<a class="reference internal" href="config.html#aepsych.config.Config" title="aepsych.config.Config"><em>Config</em></a>) – Configuration object containing the initialization parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A SemiPProbabilityObjective object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#aepsych.acquisition.objective.SemiPProbabilityObjective" title="aepsych.acquisition.objective.SemiPProbabilityObjective">SemiPProbabilityObjective</a></p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.objective.SemiPThresholdObjective">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.objective.</span></span><span class="sig-name descname"><span class="pre">SemiPThresholdObjective</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/semi_p.html#SemiPThresholdObjective"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.objective.SemiPThresholdObjective" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">SemiPObjectiveBase</span></code></p>
<p>Wraps the semi-parametric transform into an objective
that gives the threshold distribution.</p>
<p>Evaluates the probability objective.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target</strong> (<em>float</em>) – the threshold to evaluate.</p></li>
<li><p><strong>likelihood</strong> (<a class="reference internal" href="likelihoods.html#aepsych.likelihoods.LinearBernoulliLikelihood" title="aepsych.likelihoods.LinearBernoulliLikelihood"><em>LinearBernoulliLikelihood</em></a><em>, </em><em>optional</em>) – Underlying SemiP likelihood (which we use for its inverse link). Defaults to None.</p></li>
<li><p><strong>class</strong> (<em>other arguments are passed to the base</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.objective.SemiPThresholdObjective.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/semi_p.html#SemiPThresholdObjective.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.objective.SemiPThresholdObjective.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the probability objective.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>Tensor</em>) – GP samples.</p></li>
<li><p><strong>X</strong> (<em>Tensor</em><em>, </em><em>optional</em>) – Ignored, here for compatibility with the objective API.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Threshold probabilities at the specific GP sample values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.objective.SemiPThresholdObjective.from_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/semi_p.html#SemiPThresholdObjective.from_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.objective.SemiPThresholdObjective.from_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a SemiPThresholdObjective from a config object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<a class="reference internal" href="config.html#aepsych.config.Config" title="aepsych.config.Config"><em>Config</em></a>) – Configuration object containing the initialization parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A SemiPThresholdObjective object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#aepsych.acquisition.objective.SemiPThresholdObjective" title="aepsych.acquisition.objective.SemiPThresholdObjective">SemiPThresholdObjective</a></p>
</dd>
</dl>
</dd></dl>
</dd></dl>
</section>
<section id="module-aepsych.acquisition.rejection_sampler">
<span id="aepsych-acquisition-rejection-sampler-module"></span><h2>aepsych.acquisition.rejection_sampler module<a class="headerlink" href="#module-aepsych.acquisition.rejection_sampler" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.rejection_sampler.RejectionSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.rejection_sampler.</span></span><span class="sig-name descname"><span class="pre">RejectionSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/rejection_sampler.html#RejectionSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.rejection_sampler.RejectionSampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MCSampler</span></code></p>
<p>Samples from a posterior subject to the constraint that samples in constrained_idx
should be &gt;= 0.</p>
<p>If not enough feasible samples are generated, will return the least violating
samples.</p>
<p>Initialize RejectionSampler</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_samples</strong> (<em>int</em>) – Number of samples to return. Note that if fewer samples
than this number are positive in the required dimension, the remaining
samples returned will be the “least violating”, i.e. closest to 0.</p></li>
<li><p><strong>num_rejection_samples</strong> (<em>int</em>) – Number of samples to draw before rejecting.</p></li>
<li><p><strong>constrained_idx</strong> (<em>torch.Tensor</em>) – Indices of input dimensions that should be
constrained positive.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.rejection_sampler.RejectionSampler.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">posterior</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/rejection_sampler.html#RejectionSampler.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.rejection_sampler.RejectionSampler.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the rejection sampler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>posterior</strong> (<em>Posterior</em>) – The unconstrained GP posterior object
to perform rejection samples on.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Kept samples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
</section>
<section id="module-aepsych.acquisition">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-aepsych.acquisition" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.BernoulliMCMutualInformation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.</span></span><span class="sig-name descname"><span class="pre">BernoulliMCMutualInformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/mutual_information.html#BernoulliMCMutualInformation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.BernoulliMCMutualInformation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MCAcquisitionFunction</span></code></p>
<p>Mutual Information acquisition function for a bernoulli outcome.</p>
<p>Given a model and an objective link function, calculate the mutual
information of a trial at a new point and the distribution on the
latent function.</p>
<p>Objective here should give values in (0, 1) (e.g. logit or probit).</p>
<p>Single Bernoulli mutual information for active learning</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>Model</em>) – A fitted model.</p></li>
<li><p><strong>objective</strong> (<em>MCAcquisitionObjective</em>) – An MCAcquisitionObjective representing the link function
(e.g., logistic or probit)</p></li>
<li><p><strong>sampler</strong> (<em>MCSampler</em><em>, </em><em>optional</em>) – The sampler used for drawing MC samples.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.BernoulliMCMutualInformation.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aepsych.acquisition.BernoulliMCMutualInformation.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate mutual information on the candidate set <cite>X</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>Tensor</em>) – A <cite>batch_size x q x d</cite>-dim Tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor of shape <cite>batch_size x q</cite> representing the mutual
information of a hypothetical trial at X that active
learning hopes to maximize.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.BernoulliMCMutualInformation.acquisition">
<span class="sig-name descname"><span class="pre">acquisition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj_samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/mutual_information.html#BernoulliMCMutualInformation.acquisition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.BernoulliMCMutualInformation.acquisition" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the acquisition function value based on samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj_samples</strong> (<em>torch.Tensor</em>) – Samples from the model, transformed through the objective.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>value of the acquisition function (BALD) at the input samples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.MonotonicBernoulliMCMutualInformation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.</span></span><span class="sig-name descname"><span class="pre">MonotonicBernoulliMCMutualInformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/mutual_information.html#MonotonicBernoulliMCMutualInformation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.MonotonicBernoulliMCMutualInformation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aepsych.acquisition.monotonic_rejection.MonotonicMCAcquisition" title="aepsych.acquisition.monotonic_rejection.MonotonicMCAcquisition"><code class="xref py py-class docutils literal notranslate"><span class="pre">MonotonicMCAcquisition</span></code></a></p>
<p>Initialize MonotonicMCAcquisition</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>Model</em>) – Model to use, usually a MonotonicRejectionGP.</p></li>
<li><p><strong>num_samples</strong> (<em>int</em>) – Number of samples to keep from the rejection sampler. Defaults to 32.</p></li>
<li><p><strong>num_rejection_samples</strong> (<em>int</em>) – Number of rejection samples to draw. Defaults to 1024.</p></li>
<li><p><strong>objective</strong> (<em>MCAcquisitionObjective</em><em>, </em><em>optional</em>) – Objective transform of the GP output
before evaluating the acquisition. Defaults to identity transform.</p></li>
<li><p><strong>args</strong> (<em>Any</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Any</em></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.MonotonicBernoulliMCMutualInformation.acquisition">
<span class="sig-name descname"><span class="pre">acquisition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj_samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/mutual_information.html#MonotonicBernoulliMCMutualInformation.acquisition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.MonotonicBernoulliMCMutualInformation.acquisition" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the acquisition function value based on samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj_samples</strong> (<em>torch.Tensor</em>) – Samples from the model, transformed through the objective.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>value of the acquisition function (BALD) at the input samples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.MonotonicMCLSE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.</span></span><span class="sig-name descname"><span class="pre">MonotonicMCLSE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/monotonic_rejection.html#MonotonicMCLSE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.MonotonicMCLSE" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aepsych.acquisition.monotonic_rejection.MonotonicMCAcquisition" title="aepsych.acquisition.monotonic_rejection.MonotonicMCAcquisition"><code class="xref py py-class docutils literal notranslate"><span class="pre">MonotonicMCAcquisition</span></code></a></p>
<p>Level set estimation acquisition function for use with monotonic models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>Model</em>) – Underlying model object, usually should be MonotonicRejectionGP.</p></li>
<li><p><strong>deriv_constraint_points</strong> (<em>torch.Tensor</em>) – Points at which the derivative should be constrained.</p></li>
<li><p><strong>target</strong> (<em>float</em>) – Level set value to target (after the objective).</p></li>
<li><p><strong>num_samples</strong> (<em>int</em>) – Number of MC samples to draw in MC acquisition. Defaults to 32.</p></li>
<li><p><strong>num_rejection_samples</strong> (<em>int</em>) – Number of rejection samples from which to subsample monotonic ones. Defaults to 1024.</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – Parameter of the LSE acquisition function that governs exploration vs
exploitation (similarly to the same parameter in UCB). Defaults to 3.84 (1.96 ** 2), which maps to the straddle
heuristic of Bryan et al. 2005.</p></li>
<li><p><strong>objective</strong> (<em>MCAcquisitionObjective</em><em>, </em><em>optional</em>) – Objective transform. Defaults to identity transform.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.MonotonicMCLSE.acquisition">
<span class="sig-name descname"><span class="pre">acquisition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj_samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/monotonic_rejection.html#MonotonicMCLSE.acquisition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.MonotonicMCLSE.acquisition" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the acquisition function value for level set estimation in monotonic models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj_samples</strong> (<em>torch.Tensor</em>) – Tensor of samples from the model, transformed by the objective.
Expected shape is samples x batch_shape.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The acquisition function value, calculated as the difference between an exploration-exploitation term
(based on the variance and <cite>beta</cite> parameter) and the absolute difference between the mean and the target level set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.MCPosteriorVariance">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.</span></span><span class="sig-name descname"><span class="pre">MCPosteriorVariance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/mc_posterior_variance.html#MCPosteriorVariance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.MCPosteriorVariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MCAcquisitionFunction</span></code></p>
<p>Posterior variance, computed using samples so we can use objective/transform</p>
<p>Posterior Variance of Link Function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>Model</em>) – A fitted model.</p></li>
<li><p><strong>objective</strong> (<em>MCAcquisitionObjective optional</em>) – An MCAcquisitionObjective representing the link function
(e.g., logistic or probit.) applied on the difference of (usually 1-d)
two samples. Can be implemented via GenericMCObjective. Defaults tp ProbitObjective.</p></li>
<li><p><strong>sampler</strong> (<em>MCSampler</em><em>, </em><em>optional</em>) – The sampler used for drawing MC samples. Defaults to SobolQMCNormalSampler.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.MCPosteriorVariance.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aepsych.acquisition.MCPosteriorVariance.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate MCPosteriorVariance on the candidate set <cite>X</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>torch.Tensor</em>) – A <cite>batch_size x q x d</cite>-dim Tensor</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Posterior variance of link function at X that active learning
hopes to maximize</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.MCPosteriorVariance.acquisition">
<span class="sig-name descname"><span class="pre">acquisition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj_samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/mc_posterior_variance.html#MCPosteriorVariance.acquisition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.MCPosteriorVariance.acquisition" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the acquisition based on objective samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj_samples</strong> (<em>torch.Tensor</em>) – Samples from the GP, transformed by the objective.
Should be samples x batch_shape.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Acquisition function at the sampled values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.MonotonicMCPosteriorVariance">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.</span></span><span class="sig-name descname"><span class="pre">MonotonicMCPosteriorVariance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/mc_posterior_variance.html#MonotonicMCPosteriorVariance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.MonotonicMCPosteriorVariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aepsych.acquisition.monotonic_rejection.MonotonicMCAcquisition" title="aepsych.acquisition.monotonic_rejection.MonotonicMCAcquisition"><code class="xref py py-class docutils literal notranslate"><span class="pre">MonotonicMCAcquisition</span></code></a></p>
<p>Initialize MonotonicMCAcquisition</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>Model</em>) – Model to use, usually a MonotonicRejectionGP.</p></li>
<li><p><strong>num_samples</strong> (<em>int</em>) – Number of samples to keep from the rejection sampler. Defaults to 32.</p></li>
<li><p><strong>num_rejection_samples</strong> (<em>int</em>) – Number of rejection samples to draw. Defaults to 1024.</p></li>
<li><p><strong>objective</strong> (<em>MCAcquisitionObjective</em><em>, </em><em>optional</em>) – Objective transform of the GP output
before evaluating the acquisition. Defaults to identity transform.</p></li>
<li><p><strong>args</strong> (<em>Any</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Any</em></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.MonotonicMCPosteriorVariance.acquisition">
<span class="sig-name descname"><span class="pre">acquisition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj_samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/mc_posterior_variance.html#MonotonicMCPosteriorVariance.acquisition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.MonotonicMCPosteriorVariance.acquisition" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the acquisition function value for monotonic posterior variance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj_samples</strong> (<em>torch.Tensor</em>) – Samples from the GP, transformed by the objective.
Should have shape samples x batch_shape.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The BALV acquisition function value, representing the posterior variance
calculated over the sample dimension.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.MCLevelSetEstimation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.</span></span><span class="sig-name descname"><span class="pre">MCLevelSetEstimation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/lse.html#MCLevelSetEstimation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.MCLevelSetEstimation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MCAcquisitionFunction</span></code></p>
<p>Monte-carlo level set estimation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>botorch.models.model.Model</em>) – A fitted model.</p></li>
<li><p><strong>target</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>Tensor</em><em>]</em>) – the level set (after objective transform) to be estimated. Defult to 0.75.</p></li>
<li><p><strong>beta</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>Tensor</em><em>]</em>) – a parameter that governs explore-exploit tradeoff. Defult to 3.84.</p></li>
<li><p><strong>objective</strong> (<em>MCAcquisitionObjective</em><em>, </em><em>optional</em>) – An MCAcquisitionObjective representing the link function
(e.g., logistic or probit.) applied on the samples.
Can be implemented via GenericMCObjective.</p></li>
<li><p><strong>sampler</strong> (<em>MCSampler</em><em>, </em><em>optional</em>) – The sampler used for drawing MC samples.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.MCLevelSetEstimation.acquisition">
<span class="sig-name descname"><span class="pre">acquisition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj_samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/lse.html#MCLevelSetEstimation.acquisition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.MCLevelSetEstimation.acquisition" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the acquisition based on objective samples.</p>
<p>Usually you should not call this directly unless you are
subclassing this class and modifying how objective samples
are generated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj_samples</strong> (<em>torch.Tensor</em>) – Samples from the model, transformed
by the objective. Should be samples x batch_shape.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Acquisition function at the sampled values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.MCLevelSetEstimation.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aepsych.acquisition.MCLevelSetEstimation.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the acquisition function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>torch.Tensor</em>) – Points at which to evaluate.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the acquisition functiona at these points.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.ProbitObjective">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.</span></span><span class="sig-name descname"><span class="pre">ProbitObjective</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/objective.html#ProbitObjective"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.ProbitObjective" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aepsych.acquisition.objective.AEPsychObjective" title="aepsych.acquisition.objective.objective.AEPsychObjective"><code class="xref py py-class docutils literal notranslate"><span class="pre">AEPsychObjective</span></code></a></p>
<p>Probit objective</p>
<p>Transforms the input through the normal CDF (probit).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> (<em>Any</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Any</em></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.ProbitObjective.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/objective.html#ProbitObjective.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.ProbitObjective.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the objective (normal CDF).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>Tensor</em>) – GP samples.</p></li>
<li><p><strong>X</strong> (<em>Tensor</em><em>, </em><em>optional</em>) – ignored, here for compatibility
with MCAcquisitionObjective.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.ProbitObjective.inverse">
<span class="sig-name descname"><span class="pre">inverse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/objective.html#ProbitObjective.inverse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.ProbitObjective.inverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the inverse of the objective (normal PPF).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>Tensor</em>) – GP samples.</p></li>
<li><p><strong>X</strong> (<em>Tensor</em><em>, </em><em>optional</em>) – ignored, here for compatibility
with MCAcquisitionObjective.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.FloorProbitObjective">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.</span></span><span class="sig-name descname"><span class="pre">FloorProbitObjective</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/objective.html#FloorProbitObjective"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.FloorProbitObjective" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">FloorLinkObjective</span></code></p>
<p>Probit (aka Gaussian CDF), but with a floor
so that its output is between floor and 1.0.</p>
<p>Initialize the objective with a floor value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>floor</strong> (<em>float</em>) – The floor value. Defaults to 0.5.</p></li>
<li><p><strong>args</strong> (<em>Any</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Any</em></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.FloorProbitObjective.link">
<span class="sig-name descname"><span class="pre">link</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/objective.html#FloorProbitObjective.link"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.FloorProbitObjective.link" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the link function for input x and floor f</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>samples</strong> (<em>Tensor</em>) – GP samples.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the cumulative distribution function of the standard normal distribution of the input samples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.FloorProbitObjective.inverse_link">
<span class="sig-name descname"><span class="pre">inverse_link</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/objective.html#FloorProbitObjective.inverse_link"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.FloorProbitObjective.inverse_link" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the inverse link function for input x and floor f</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>samples</strong> (<em>Tensor</em>) – GP samples.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the inverse cumulative distribution function of the standard normal distribution of the input samples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.FloorLogitObjective">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.</span></span><span class="sig-name descname"><span class="pre">FloorLogitObjective</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/objective.html#FloorLogitObjective"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.FloorLogitObjective" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">FloorLinkObjective</span></code></p>
<p>Logistic sigmoid (aka expit, aka logistic CDF),
but with a floor so that its output is
between floor and 1.0.</p>
<p>Initialize the objective with a floor value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>floor</strong> (<em>float</em>) – The floor value. Defaults to 0.5.</p></li>
<li><p><strong>args</strong> (<em>Any</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Any</em></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.FloorLogitObjective.link">
<span class="sig-name descname"><span class="pre">link</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/objective.html#FloorLogitObjective.link"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.FloorLogitObjective.link" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the link function for input x and floor f</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>samples</strong> (<em>Tensor</em>) – GP samples.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The Expit function applied to the input samples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.FloorLogitObjective.inverse_link">
<span class="sig-name descname"><span class="pre">inverse_link</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/objective.html#FloorLogitObjective.inverse_link"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.FloorLogitObjective.inverse_link" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the inverse link function for input x and floor f</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>samples</strong> (<em>Tensor</em>) – GP samples.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The logarithm of the inverse link function applied to the input samples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.FloorGumbelObjective">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.</span></span><span class="sig-name descname"><span class="pre">FloorGumbelObjective</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/objective.html#FloorGumbelObjective"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.FloorGumbelObjective" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">FloorLinkObjective</span></code></p>
<p>Gumbel CDF but with a floor so that its output
is between floor and 1.0. Note that this is not
the standard Gumbel distribution, but rather the
left-skewed Gumbel that arises as the log of the Weibull
distribution, e.g. Treutwein 1995, doi:10.1016/0042-6989(95)00016-X.</p>
<p>Initialize the objective with a floor value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>floor</strong> (<em>float</em>) – The floor value. Defaults to 0.5.</p></li>
<li><p><strong>args</strong> (<em>Any</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Any</em></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.FloorGumbelObjective.link">
<span class="sig-name descname"><span class="pre">link</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/objective.html#FloorGumbelObjective.link"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.FloorGumbelObjective.link" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the link function for input x and floor f</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>samples</strong> (<em>Tensor</em>) – GP samples.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Transformed tensor with the link function applied, where positive infinity values are replaced with 1.0 and negative infinity values are replaced with 0.0.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="aepsych.acquisition.FloorGumbelObjective.inverse_link">
<span class="sig-name descname"><span class="pre">inverse_link</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/objective/objective.html#FloorGumbelObjective.inverse_link"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.FloorGumbelObjective.inverse_link" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the inverse link function for input x and floor f</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>samples</strong> (<em>Tensor</em>) – GP samples.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The logarithm of the inverse link function applied to the input samples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.GlobalMI">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.</span></span><span class="sig-name descname"><span class="pre">GlobalMI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/lookahead.html#GlobalMI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.GlobalMI" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aepsych.acquisition.lookahead.GlobalLookaheadAcquisitionFunction" title="aepsych.acquisition.lookahead.GlobalLookaheadAcquisitionFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">GlobalLookaheadAcquisitionFunction</span></code></a></p>
<p>A global look-ahead acquisition function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>GPyTorchModel</em>) – The gpytorch model to use.</p></li>
<li><p><strong>lookahead_type</strong> (<em>Literal</em><em>[</em><em>"levelset"</em><em>, </em><em>"posterior"</em><em>]</em>) – The type of look-ahead to perform (default is “levelset”).
- If the lookahead_type is “levelset”, the acqf will consider the posterior probability that a point is above or below the target level set.
- If the lookahead_type is “posterior”, the acqf will consider the posterior probability that a point will be detected or not.</p></li>
<li><p><strong>target</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold value to target in p-space.</p></li>
<li><p><strong>posterior_transform</strong> (<em>PosteriorTransform</em><em>, </em><em>optional</em>) – Optional transformation to apply to the posterior.</p></li>
<li><p><strong>query_set_size</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of points in the query set.</p></li>
<li><p><strong>Xq</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – (m x d) global reference set.</p></li>
<li><p><strong>args</strong> (<em>Any</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Any</em></p>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.GlobalSUR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.</span></span><span class="sig-name descname"><span class="pre">GlobalSUR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/lookahead.html#GlobalSUR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.GlobalSUR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aepsych.acquisition.lookahead.GlobalLookaheadAcquisitionFunction" title="aepsych.acquisition.lookahead.GlobalLookaheadAcquisitionFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">GlobalLookaheadAcquisitionFunction</span></code></a></p>
<p>A global look-ahead acquisition function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>GPyTorchModel</em>) – The gpytorch model to use.</p></li>
<li><p><strong>lookahead_type</strong> (<em>Literal</em><em>[</em><em>"levelset"</em><em>, </em><em>"posterior"</em><em>]</em>) – The type of look-ahead to perform (default is “levelset”).
- If the lookahead_type is “levelset”, the acqf will consider the posterior probability that a point is above or below the target level set.
- If the lookahead_type is “posterior”, the acqf will consider the posterior probability that a point will be detected or not.</p></li>
<li><p><strong>target</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold value to target in p-space.</p></li>
<li><p><strong>posterior_transform</strong> (<em>PosteriorTransform</em><em>, </em><em>optional</em>) – Optional transformation to apply to the posterior.</p></li>
<li><p><strong>query_set_size</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of points in the query set.</p></li>
<li><p><strong>Xq</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – (m x d) global reference set.</p></li>
<li><p><strong>args</strong> (<em>Any</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Any</em></p>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.ApproxGlobalSUR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.</span></span><span class="sig-name descname"><span class="pre">ApproxGlobalSUR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/lookahead.html#ApproxGlobalSUR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.ApproxGlobalSUR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aepsych.acquisition.lookahead.GlobalSUR" title="aepsych.acquisition.lookahead.GlobalSUR"><code class="xref py py-class docutils literal notranslate"><span class="pre">GlobalSUR</span></code></a></p>
<p>An approximate global look-ahead acquisition function.
:param model: The gpytorch model to use.
:type model: GPyTorchModel
:param lookahed_type: The type of look-ahead to perform (default is “levelset”).
:type lookahed_type: str
:param target: Threshold value to target in p-space.
:type target: float, optional
:param query_set_size: Number of points in the query set.
:type query_set_size: int, optional
:param Xq: (m x d) global reference set.
:type Xq: torch.Tensor, optional</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>botorch.models.gpytorch.GPyTorchModel</em>) – </p></li>
<li><p><strong>target</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>query_set_size</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – </p></li>
<li><p><strong>Xq</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.EAVC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.</span></span><span class="sig-name descname"><span class="pre">EAVC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/lookahead.html#EAVC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.EAVC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aepsych.acquisition.lookahead.GlobalLookaheadAcquisitionFunction" title="aepsych.acquisition.lookahead.GlobalLookaheadAcquisitionFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">GlobalLookaheadAcquisitionFunction</span></code></a></p>
<p>A global look-ahead acquisition function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>GPyTorchModel</em>) – The gpytorch model to use.</p></li>
<li><p><strong>lookahead_type</strong> (<em>Literal</em><em>[</em><em>"levelset"</em><em>, </em><em>"posterior"</em><em>]</em>) – The type of look-ahead to perform (default is “levelset”).
- If the lookahead_type is “levelset”, the acqf will consider the posterior probability that a point is above or below the target level set.
- If the lookahead_type is “posterior”, the acqf will consider the posterior probability that a point will be detected or not.</p></li>
<li><p><strong>target</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold value to target in p-space.</p></li>
<li><p><strong>posterior_transform</strong> (<em>PosteriorTransform</em><em>, </em><em>optional</em>) – Optional transformation to apply to the posterior.</p></li>
<li><p><strong>query_set_size</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of points in the query set.</p></li>
<li><p><strong>Xq</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – (m x d) global reference set.</p></li>
<li><p><strong>args</strong> (<em>Any</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Any</em></p>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.LocalMI">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.</span></span><span class="sig-name descname"><span class="pre">LocalMI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/lookahead.html#LocalMI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.LocalMI" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aepsych.acquisition.lookahead.LocalLookaheadAcquisitionFunction" title="aepsych.acquisition.lookahead.LocalLookaheadAcquisitionFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocalLookaheadAcquisitionFunction</span></code></a></p>
<p>A localized look-ahead acquisition function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>GPyTorchModel</em>) – The gpytorch model to use.</p></li>
<li><p><strong>lookahead_type</strong> (<em>Literal</em><em>[</em><em>"levelset"</em><em>, </em><em>"posterior"</em><em>]</em>) – The type of look-ahead to perform (default is “levelset”).
- If the lookahead_type is “levelset”, the acqf will consider the posterior probability that a point is above or below the target level set.
- If the lookahead_type is “posterior”, the acqf will consider the posterior probability that a point will be detected or not.</p></li>
<li><p><strong>target</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold value to target in p-space.</p></li>
<li><p><strong>posterior_transform</strong> (<em>PosteriorTransform</em><em>, </em><em>optional</em>) – Optional transformation to apply to the posterior. Default: None.</p></li>
<li><p><strong>args</strong> (<em>Any</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Any</em></p>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="aepsych.acquisition.LocalSUR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aepsych.acquisition.</span></span><span class="sig-name descname"><span class="pre">LocalSUR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aepsych/acquisition/lookahead.html#LocalSUR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aepsych.acquisition.LocalSUR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aepsych.acquisition.lookahead.LocalLookaheadAcquisitionFunction" title="aepsych.acquisition.lookahead.LocalLookaheadAcquisitionFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocalLookaheadAcquisitionFunction</span></code></a></p>
<p>A localized look-ahead acquisition function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>GPyTorchModel</em>) – The gpytorch model to use.</p></li>
<li><p><strong>lookahead_type</strong> (<em>Literal</em><em>[</em><em>"levelset"</em><em>, </em><em>"posterior"</em><em>]</em>) – The type of look-ahead to perform (default is “levelset”).
- If the lookahead_type is “levelset”, the acqf will consider the posterior probability that a point is above or below the target level set.
- If the lookahead_type is “posterior”, the acqf will consider the posterior probability that a point will be detected or not.</p></li>
<li><p><strong>target</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold value to target in p-space.</p></li>
<li><p><strong>posterior_transform</strong> (<em>PosteriorTransform</em><em>, </em><em>optional</em>) – Optional transformation to apply to the posterior. Default: None.</p></li>
<li><p><strong>args</strong> (<em>Any</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Any</em></p>
</dd>
</dl>
</dd></dl>
</section>
</section>
</div>
</div>
</div>
<div aria-label="main navigation" class="sphinxsidebar" role="navigation">
<div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">AEPsych</a></h1>
<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">aepsych.acquisition</a></li>
<li class="toctree-l1"><a class="reference internal" href="benchmark.html">aepsych.benchmark</a></li>
<li class="toctree-l1"><a class="reference internal" href="database.html">aepsych.database</a></li>
<li class="toctree-l1"><a class="reference internal" href="factory.html">aepsych.factory</a></li>
<li class="toctree-l1"><a class="reference internal" href="generators.html">aepsych.generators</a></li>
<li class="toctree-l1"><a class="reference internal" href="kernels.html">aepsych.kernels</a></li>
<li class="toctree-l1"><a class="reference internal" href="means.html">aepsych.means</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">aepsych.models</a></li>
<li class="toctree-l1"><a class="reference internal" href="server.html">aepsych.server</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">aepsych.config</a></li>
<li class="toctree-l1"><a class="reference internal" href="likelihoods.html">aepsych.likelihoods</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting.html">aepsych.plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="strategy.html">aepsych.strategy</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils_logging.html">aepsych.utils_logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">aepsych.utils</a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
<li><a href="index.html">Documentation overview</a><ul>
<li>Previous: <a href="index.html" title="previous chapter">AEPsych API Reference</a></li>
<li>Next: <a href="benchmark.html" title="next chapter">aepsych.benchmark</a></li>
</ul></li>
</ul>
</div>
<div id="searchbox" role="search" style="display: none">
<h3 id="searchlabel">Quick search</h3>
<div class="searchformwrapper">
<form action="search.html" class="search" method="get">
<input aria-labelledby="searchlabel" autocapitalize="off" autocomplete="off" autocorrect="off" name="q" spellcheck="false" type="text"/>
<input type="submit" value="Go"/>
</form>
</div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
</div>
</div>
<div class="clearer"></div>
</div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/favicon.ico" alt="AEPsych" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/introduction">Introduction</a><a href="/docs/getting_started">Getting Started</a><a href="/tutorials/">Tutorials</a><a href="/api/">API Reference</a></div><div><h5>Legal</h5><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noreferrer noopener">Privacy</a><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noreferrer noopener">Terms</a></div><div><div class="footerSection"><h5>Social</h5><div class="social"><a class="github-button" href="https://github.com/facebookresearch/aepsych" data-count-href="https://github.com/facebookresearch/aepsych/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star AEPsych on GitHub">aepsych</a></div></div></div></section><a href="https://opensource.facebook.com/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2024 Meta, Inc.  Built with Docusaurus.</section><div class="cookie-container"><p>We use cookies to enhance your experience, and to analyse the use of our website. By clicking or navigating, you agree to allow our usage of cookies.</p><button class="cookie-btn">accept</button></div></footer></div></body></html>